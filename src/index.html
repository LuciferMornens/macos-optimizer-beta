<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>macOS Optimizer</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app">
        <nav class="sidebar">
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                    <circle cx="16" cy="16" r="14" stroke="currentColor" stroke-width="2"/>
                    <path d="M16 8v8l6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <h1>macOS Optimizer</h1>
            </div>
            <ul class="nav-menu">
                <li class="nav-item active" data-tab="dashboard">
                    <svg class="icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="3" y="3" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                        <rect x="11" y="3" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                        <rect x="3" y="11" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                        <rect x="11" y="11" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    <span>Dashboard</span>
                </li>
                <li class="nav-item" data-tab="memory">
                    <svg class="icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="2" y="6" width="16" height="8" rx="1" stroke="currentColor" stroke-width="1.5"/>
                        <line x1="6" y1="10" x2="14" y2="10" stroke="currentColor" stroke-width="1.5"/>
                    </svg>
                    <span>Memory</span>
                </li>
                <li class="nav-item" data-tab="storage">
                    <svg class="icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="3" y="3" width="14" height="14" rx="2" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M7 10h6M7 13h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>Storage Cleaner</span>
                </li>
                <li class="nav-item" data-tab="processes">
                    <svg class="icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <circle cx="10" cy="10" r="7" stroke="currentColor" stroke-width="1.5"/>
                        <path d="M10 7v3l2 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <span>Processes</span>
                </li>
            </ul>
        </nav>

        <main class="content">
            <!-- Dashboard Tab -->
            <div class="tab-content active" id="dashboard">
                <div class="header">
                    <h2>System Overview</h2>
                    <button class="btn btn-primary" id="quick-optimize">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M8 2v6M4 8l4 4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        Quick Optimize
                    </button>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Memory Usage</span>
                            <span class="stat-icon">üíæ</span>
                        </div>
                        <div class="stat-value" id="memory-usage">--</div>
                        <div class="stat-detail" id="memory-detail">-- / --</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="memory-progress"></div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">CPU Usage</span>
                            <span class="stat-icon">‚ö°</span>
                        </div>
                        <div class="stat-value" id="cpu-usage">--</div>
                        <div class="stat-detail" id="cpu-detail">-- cores</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="cpu-progress"></div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Disk Usage</span>
                            <span class="stat-icon">üíø</span>
                        </div>
                        <div class="stat-value" id="disk-usage">--</div>
                        <div class="stat-detail" id="disk-detail">-- / --</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="disk-progress"></div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">System Uptime</span>
                            <span class="stat-icon">‚è±Ô∏è</span>
                        </div>
                        <div class="stat-value" id="uptime">--</div>
                        <div class="stat-detail" id="system-info">macOS --</div>
                    </div>
                </div>

                <div class="system-details">
                    <h3>System Information</h3>
                    <div class="info-grid" id="system-details">
                        <div class="info-item">
                            <span class="info-label">OS Version:</span>
                            <span class="info-value" id="os-version">Loading...</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Hostname:</span>
                            <span class="info-value" id="hostname">Loading...</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Boot Time:</span>
                            <span class="info-value" id="boot-time">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Memory Tab -->
            <div class="tab-content" id="memory">
                <div class="header">
                    <h2>Memory Management</h2>
                    <div class="button-group">
                        <button class="btn btn-secondary" id="refresh-memory">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M14 8A6 6 0 1 1 8 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M14 2v4h-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Refresh
                        </button>
                        <button class="btn btn-primary" id="optimize-memory">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M8 2v12M4 8h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            Optimize Memory
                        </button>
                        <button class="btn btn-danger" id="deep-clean-memory">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M8 2L2 8l6 6M14 2l-6 6 6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            Deep Clean (Admin)
                        </button>
                    </div>
                </div>

                <!-- Memory progress container -->
                <div id="memory-progress-container" style="display: none; margin-bottom: 20px;"></div>

                <div class="memory-overview">
                    <div class="memory-chart">
                        <canvas id="memory-chart"></canvas>
                    </div>
                    <div class="memory-stats">
                        <div class="memory-stat">
                            <span class="label">Total Memory</span>
                            <span class="value" id="total-memory">--</span>
                        </div>
                        <div class="memory-stat">
                            <span class="label">Used Memory</span>
                            <span class="value" id="used-memory">--</span>
                        </div>
                        <div class="memory-stat">
                            <span class="label">Available Memory</span>
                            <span class="value" id="available-memory">--</span>
                        </div>
                        <div class="memory-stat">
                            <span class="label">Memory Pressure</span>
                            <span class="value" id="memory-pressure">--</span>
                        </div>
                        <div class="memory-stat">
                            <span class="label">Swap Used</span>
                            <span class="value" id="swap-used">--</span>
                        </div>
                    </div>
                </div>

                <div class="optimization-result" id="optimization-result" style="display: none;">
                    <h3>Optimization Results</h3>
                    <div class="result-content"></div>
                </div>
            </div>

            <!-- Storage Tab -->
            <div class="tab-content" id="storage">
                <div class="header">
                    <h2>Storage Cleaner</h2>
                    <div class="button-group">
                        <button class="btn btn-secondary" id="scan-files">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M8 5v3l2 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Scan System
                        </button>
                        <button class="btn btn-danger" id="clean-selected" disabled>
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M3 4h10M5 4V3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v1M6 7v4M10 7v4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Clean Selected
                        </button>
                    </div>
                </div>

                <div class="scan-progress" id="scan-progress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill animated"></div>
                    </div>
                    <p>Scanning system for cleanable files...</p>
                </div>

                <div class="cleaning-report" id="cleaning-report" style="display: none;">
                    <div class="report-summary">
                        <h3>Scan Results</h3>
                        <div class="summary-stats">
                            <div class="summary-stat">
                                <span class="label">Total Size:</span>
                                <span class="value" id="total-cleanable">--</span>
                            </div>
                            <div class="summary-stat">
                                <span class="label">Files Found:</span>
                                <span class="value" id="files-found">--</span>
                            </div>
                        </div>
                    </div>

                    <div class="smart-selection">
                        <h4>Smart Selection</h4>
                        <div class="selection-controls">
                            <button class="btn btn-primary" id="auto-select-safe">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path d="M6 8l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Auto-Select Safe Files
                            </button>
                            <button class="btn btn-secondary" id="select-by-safety">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <rect x="3" y="3" width="10" height="10" rx="1" stroke="currentColor" stroke-width="1.5"/>
                                    <path d="M6 8l2 2 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Select Very Safe (95+)
                            </button>
                            <button class="btn btn-secondary" id="clear-selection">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path d="M5 5l6 6M11 5l-6 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                                Clear Selection
                            </button>
                        </div>
                        <div class="selection-info">
                            <span id="selected-count">0 files selected</span>
                            <span id="selected-size">0 B</span>
                        </div>
                    </div>

                    <div class="filters-row" style="display: flex; align-items: center; gap: 12px; margin: 8px 0; justify-content: space-between;">
                        <label style="display:flex; align-items:center; gap:8px; cursor:pointer;">
                            <input type="checkbox" id="toggle-advanced">
                            <span>Show advanced categories</span>
                        </label>
                        <div class="button-group">
                            <button class="btn btn-secondary" id="empty-trash" title="Permanently empty your Trash">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path d="M3 4h10M5 4V3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v1M6 7v4M10 7v4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                                Empty Trash
                            </button>
                        </div>
                    </div>

                    <div class="categories-list" id="categories-list">
                        <!-- Categories will be populated here -->
                    </div>

                    <div class="category-actions" id="category-actions" style="display:none; align-items:center; justify-content:space-between; margin: 8px 0;">
                        <div>
                            <strong>Category:</strong> <span id="current-category-name">‚Äî</span>
                        </div>
                        <div class="button-group">
                            <button class="btn btn-secondary" id="clear-category-filter">Clear Filter</button>
                            <button class="btn btn-danger" id="clean-this-category">Clean This Category</button>
                        </div>
                    </div>

                    <div class="files-list" id="files-list">
                        <!-- Files will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Processes Tab -->
            <div class="tab-content" id="processes">
                <div class="header">
                    <h2>Process Manager</h2>
                    <div class="button-group">
                        <button class="btn btn-secondary" id="refresh-processes">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M14 8A6 6 0 1 1 8 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M14 2v4h-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Refresh
                        </button>
                    </div>
                </div>

                <div class="processes-filter">
                    <input type="text" id="process-search" placeholder="Search processes...">
                    <select id="process-sort">
                        <option value="memory">Sort by Memory</option>
                        <option value="cpu">Sort by CPU</option>
                        <option value="name">Sort by Name</option>
                    </select>
                </div>

                <div class="processes-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Process Name</th>
                                <th>PID</th>
                                <th>CPU %</th>
                                <th title="Resident Set Size (physical memory in use)">Memory (RSS)</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="processes-list">
                            <!-- Processes will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- Skeleton loader for dashboard stats -->
    <div class="skeleton-loader" id="dashboard-skeleton" style="display: none;">
        <div class="skeleton-stat-card">
            <div class="skeleton-line skeleton-title"></div>
            <div class="skeleton-line skeleton-value"></div>
            <div class="skeleton-line skeleton-detail"></div>
            <div class="skeleton-progress"></div>
        </div>
        <div class="skeleton-stat-card">
            <div class="skeleton-line skeleton-title"></div>
            <div class="skeleton-line skeleton-value"></div>
            <div class="skeleton-line skeleton-detail"></div>
            <div class="skeleton-progress"></div>
        </div>
        <div class="skeleton-stat-card">
            <div class="skeleton-line skeleton-title"></div>
            <div class="skeleton-line skeleton-value"></div>
            <div class="skeleton-line skeleton-detail"></div>
            <div class="skeleton-progress"></div>
        </div>
    </div>

    <!-- Loading overlay for operations -->
    <div class="loading-overlay" id="global-loading">
        <div class="loading-spinner">
            <svg class="spinner" viewBox="0 0 50 50">
                <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>
            </svg>
        </div>
        <div class="loading-text">Processing...</div>
    </div>

    <!-- Global activity indicator -->
    <div class="activity-indicator" id="activity-indicator">
        <div class="activity-dot"></div>
        <span class="activity-text">Background operation in progress</span>
    </div>

    <!-- Operation history panel -->
    <div class="operation-history" id="operation-history">
        <h4>Recent Operations</h4>
        <div id="operation-history-list">
            <!-- Dynamically populated -->
        </div>
        <button class="btn btn-link" id="toggle-history" style="margin-top: 8px; font-size: 12px;">Hide History</button>
    </div>

    <div class="notification" id="notification">
        <div class="notification-content">
            <span class="notification-message"></span>
            <button class="notification-close">√ó</button>
        </div>
    </div>

    <!-- Import JavaScript modules -->
    <script src="js/progress-manager.js"></script>
    <script src="js/operation-queue.js"></script>
    <script src="main.js" type="module"></script>
</body>
</html>
